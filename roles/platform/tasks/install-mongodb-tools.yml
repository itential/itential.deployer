# Copyright (c) 2024, Itential, Inc
# GNU General Public License v3.0+ (see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt)
---

# TODO:  Can this file be removed?

# Install the mongodb repo if mongodb is not already installed. The platform role
# will need mongo cmd line tools to import some initial data. It does not install
# the database, just the cmd line tools and the mongo shell.
- name: Install MongoDB tools
  when:
    - platform_bootstrap_configs | bool
    - not offline_install_enabled
  block:
    - name: Install mongodb repo (for cmd line tools)
      ansible.builtin.yum_repository:
        name: "mongodb"
        description: MongoDB Repository
        baseurl: "{{ platform_mongodb_release_url }}"
        enabled: true
        gpgcheck: true
        gpgkey: "{{ platform_mongodb_gpgkey_url }}"
      when: install_yum_repos | bool

    # Install mongodb tools if they are not already installed
    - name: Install the MongoDB tools packages
      ansible.builtin.dnf:
        name: "{{ platform_mongodb_tools_packages }}"
        state: present
