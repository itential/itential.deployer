# Copyright (c) 2024, Itential, Inc
# GNU General Public License v3.0+ (see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt)
---
- name: Create scrape config file
  notify: Restart Prometheus
  block:
    - name: Create scrape config file
      ansible.builtin.template:
        src: scrape_configs.j2
        dest: /etc/prometheus/scrapes/itential.yml
        owner: "{{ prometheus_system_user }}"
        group: "{{ prometheus_system_group }}"
        mode: "0644"
        lstrip_blocks: true
        # trim_blocks: true
      register: create_scrape_config_result
