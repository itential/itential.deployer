# Copyright (c) 2024, Itential, Inc
# GNU General Public License v3.0+ (see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt)
---
### Itential Platform
- name: Install Itential Platform
  hosts: platform, platform_secondary
  become: true
  roles:
    # Pull in the common vars
    - role: itential.deployer.common
      tags: always

    # Perform a base installation of Itential Platform
    - role: itential.deployer.platform
      tags:
        - platform
        - platform_install

  tasks:
    # Install app-artifacts into Itential Platform
    # This should only be done in development environments
    - name: Install app-artifacts
      ansible.builtin.import_role:
        name: itential.deployer.platform
        tasks_from: install-app-artifacts
      when: platform_app_artifacts_enabled | bool
      tags:
        - platform
        - platform_app_artifacts

    # Install any listed apps and/or adapters
    - name: Install adapters
      ansible.builtin.import_role:
        name: itential.deployer.platform
        tasks_from: install-adapters
      tags:
        - platform
        - platform_adapters
